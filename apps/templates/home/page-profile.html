{% extends "layouts/base.html" %}

{% block title %} User Profile {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <!-- Header -->
    <div class="header pb-6 d-flex align-items-center" style="min-height: 500px; background-image: url('/media/{{request.user.profile.picture}}'); background-size: cover; background-position: center top;">
      <!-- Default background image to save url(/static/assets/img/theme/profile-cover.jpg) -->
      <!-- Mask -->
      <span class="mask bg-gradient-default opacity-8"></span>
      <!-- Header container -->
      <div class="container-fluid d-flex align-items-center">
        <div class="row">
          <div class="col-lg-7 col-md-10">
            {% if messages %}
              <!-- Alerts -->
              <div class="alert alert-success alert-dismissible fade show" role="alert">
                <span class="alert-icon"><i class="ni ni-like-2"></i></span>
                <span class="alert-text">
                  <strong>Success!</strong>
                  {% for message in messages %}
                    {{ message | safe }}
                  {% endfor %}
                </span>
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            {% endif %}
            <h1 class="display-2 text-white">Bonjour <br> {{ request.user.first_name }} {{ request.user.last_name }} </h1>
            <!-- <p class="text-white mt-0 mb-5">This is your profile page. You can see the progress you've made with your work and manage your projects or assigned tasks</p> -->
            <p class="text-white mt-0 mb-5">Ceci est votre page de profil. Vous pouvez visualier le progrès effectué sur les différentes tâches et gérer vos activités.</p>
            <!-- <a href="{% url 'authentication:edit_user' request.user.id %}" class="btn btn-neutral">Modifier</a> -->
            <span>
              <button class="btn btn-neutral" role="button" data-id="a-utilisateurs-edit-profil" data-toggle="modal" data-target="#modal-user-edit">Modifier</button>
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Page content -->
    <div class="container-fluid mt--6">

      <div class="row">
        <div class="col-xl-6 order-xl-1">
          <div class="card card-profile">
            {% if request.user.profile.picture %}
              <img src="{{request.user.profile.picture.url}}" alt="Logo" class="card-img-top" style="max-height: 226px;">
            {% else %}
              <img src="/static/assets/img/theme/img-1-1000x600.jpg" alt="Image placeholder" class="card-img-top">
            {% endif %}
            <div class="row justify-content-center">
              <div class="col-lg-3 order-lg-2">
                <div class="card-profile-image">
                  <a href="#">
                    {% if request.user.picture %}
                      <img src="{{request.user.picture.url}}" alt="Photo" class="rounded-circle">
                    {% else %}
                      <img src="/static/assets/img/theme/team-4.jpg" class="rounded-circle">
                    {% endif %}
                  </a>
                </div>
              </div>
            </div>
            <div class="card-header text-center border-0 pt-8 pt-md-4 pb-0 pb-md-4">
              <div class="d-flex justify-content-between">
                <a href="#" class="btn btn-sm btn-info  mr-4 ">{{request.user.type}}</a>
                <a href="#" class="btn btn-sm btn-default float-right">
                  {% if request.user.job %}
                    {{request.user.job}}
                  {% else %}
                    Inconnu
                  {% endif %}
                </a>
              </div>
            </div>
            <div class="card-body pt-0">
              <div class="row">
                <div class="col">
                  <div class="card-profile-stats d-flex justify-content-center">
                    <div>
                      <span class="heading"> {% if request.user.location %}{{request.user.location}}{% else %}Inconnu{% endif %} </span>
                      <span class="description">Emplacement</span>
                    </div>
                    <div>
                      <span class="heading"> {% if request.user.agency %}{{request.user.agency}}{% else %}Inconnu{% endif %} </span>
                      <span class="description">Agence</span>
                    </div>
                    <div>
                      <span class="heading">
                        {% if request.user.is_active %} 
                          Actif
                          <span class="badge badge-dot">
                            <i class="bg-success"></i> 
                          </span>
                        {% else %}
                          Inactif
                          <span class="badge badge-dot">
                            <i class="bg-danger"></i> 
                          </span>
                        {% endif %}
                      </span>
                      <span class="description">Statut</span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="text-center">
                <h2 class="h2">
                  {{request.user.first_name}} {{request.user.last_name}}
                </h2>
                <div class="h5 mt-2 mb-5">
                  <span class="float-left"><i class="fas fa-envelope mr-2"></i> {{request.user.email}}</span> 
                  <span class="float-right"><i class="fas fa-phone mr-2"></i> {{request.user.phone}}</span>
                </div>
                <div>
                  <i class="ni education_hat mr-2"></i><strong>Permissions:</strong> {{request.user.permissions.name}}<br>
                  <!-- Persmissions Handles here -->
                </div>
              </div>
              
            </div>
          </div>
          
        </div>
        <div class="col-xl-6 order-xl-2">
          <div class="row">
            <div class="col-lg-6">
              <div class="card bg-gradient-info border-0">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0 text-white">Total traffic</h5>
                      <span class="h2 font-weight-bold mb-0 text-white">350,897</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-white text-dark rounded-circle shadow">
                        <i class="ni ni-active-40"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-white mr-2"><i class="fa fa-arrow-up"></i> 3.48%</span>
                    <span class="text-nowrap text-light">Since last month</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="card bg-gradient-danger border-0">
                <!-- Card body -->
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <h5 class="card-title text-uppercase text-muted mb-0 text-white">Performance</h5>
                      <span class="h2 font-weight-bold mb-0 text-white">49,65%</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape bg-white text-dark rounded-circle shadow">
                        <i class="ni ni-spaceship"></i>
                      </div>
                    </div>
                  </div>
                  <p class="mt-3 mb-0 text-sm">
                    <span class="text-white mr-2"><i class="fa fa-arrow-up"></i> 3.48%</span>
                    <span class="text-nowrap text-light">Since last month</span>
                  </p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Progress track -->
          <div class="card">
            <!-- Card header -->
            <div class="card-header">
              <!-- Title -->
              <h5 class="h3 mb-0">Progress track</h5>
            </div>
            <!-- Card body -->
            <div class="card-body">
              <!-- List group -->
              <ul class="list-group list-group-flush list my--3">
                <li class="list-group-item px-0">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <!-- Avatar -->
                      <a href="#" class="avatar rounded-circle">
                        <img alt="Image placeholder" src="/static/assets/img/theme/bootstrap.jpg">
                      </a>
                    </div>
                    <div class="col">
                      <h5>Argon Design System</h5>
                      <div class="progress progress-xs mb-0">
                        <div class="progress-bar bg-orange" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;"></div>
                      </div>
                    </div>
                  </div>
                </li>
                
                <li class="list-group-item px-0">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <!-- Avatar -->
                      <a href="#" class="avatar rounded-circle">
                        <img alt="Image placeholder" src="/static/assets/img/theme/sketch.jpg">
                      </a>
                    </div>
                    <div class="col">
                      <h5>Black Dashboard</h5>
                      <div class="progress progress-xs mb-0">
                        <div class="progress-bar bg-red" role="progressbar" aria-valuenow="72" aria-valuemin="0" aria-valuemax="100" style="width: 72%;"></div>
                      </div>
                    </div>
                  </div>
                </li>
                <li class="list-group-item px-0">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <!-- Avatar -->
                      <a href="#" class="avatar rounded-circle">
                        <img alt="Image placeholder" src="/static/assets/img/theme/react.jpg">
                      </a>
                    </div>
                    <div class="col">
                      <h5>React Material Dashboard</h5>
                      <div class="progress progress-xs mb-0">
                        <div class="progress-bar bg-teal" role="progressbar" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100" style="width: 90%;"></div>
                      </div>
                    </div>
                  </div>
                </li>
                <li class="list-group-item px-0">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <!-- Avatar -->
                      <a href="#" class="avatar rounded-circle">
                        <img alt="Image placeholder" src="/static/assets/img/theme/vue.jpg">
                      </a>
                    </div>
                    <div class="col">
                      <h5>Vue Paper UI Kit PRO</h5>
                      <div class="progress progress-xs mb-0">
                        <div class="progress-bar bg-green" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;"></div>
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>

          <div class="modal fade" id="modal-user-edit" tabindex="-1" role="dialog" aria-labelledby="modal-user-edit" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered" role="dialog">
              <div class="modal-content">
                <div class="modal-header">
                </div>
                <div class="modal-body mt--4">
                  <div class="card">
                    <div class="card-header">
                      <div class="row align-items-center">
                        <div class="col-8">
                          <h3 class="mb-0">Modifier votre profil </h3>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <form role="form" action="{% url 'home:page_profile_edit' user_id %}" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <!-- Input groups with icon -->
                        <fieldset class="fieldset">
                          <legend></legend>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-file-signature"></i></span>
                                  </div>
                                  {{ userform.first_name }}
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-file-signature"></i></span>
                                  </div>
                                  {{ userform.last_name }}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                  </div>
                                  {{ userform.email }}
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                  </div>
                                  {{ userform.phone }}
                                </div>
                              </div>
                            </div>
                          </div>
                          
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-location-arrow"></i></span>
                                  </div>
                                  {{ userform.location }}
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-map-marker"></i></span>
                                  </div>
                                  {{ userform.agency }}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  {{ userform.picture }}
                                  <div class="input-group-append">
                                    <span class="input-group-text"><i class="fas fa-image"></i></span>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <div class="input-group input-group-merge">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-briefcase"></i></span>
                                  </div>
                                  {{ userform.job }}
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            {{ userform.permissions.as_hidden }}
                            {{ userform.type.as_hidden }}
                          </div>
                        </fieldset>
                        <div class="card-footer">
                          <div class="row justify-content-center">
                              <input type="button" class="btn btn-secondary" data-dismiss="modal" value="Annuler">
                              <input type="submit" class="btn btn-primary" value="Enregistrer">
                          </div>
                        </div>
        
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
        </div>
      </div>

      {% include 'includes/footer.html' %}

    </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
  <script>
    setTimeout(function() {
        $(".alert").alert('close');
    }, 3000);
  </script>
{% endblock javascripts %}
 